<header class="header">
    <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom d-none d-lg-flex">
        <div class="container-fluid">
            <a class="navbar-brand" routerLink="/">
                <img src="Logo.png" alt="Easy Space" height="50">
            </a>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item mx-2">
                        <a class="nav-link d-flex flex-column align-items-center hover-yellow" routerLink="/"
                            routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                            <i class="bi bi-house-door fs-5"></i>
                            <span>Home</span>
                        </a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link d-flex flex-column align-items-center hover-yellow" routerLink="/explorar"
                            routerLinkActive="active">
                            <i class="bi bi-search fs-5"></i>
                            <span>Explorar</span>
                        </a>
                    </li>
                    <li class="nav-item mx-2">
                        <a class="nav-link d-flex flex-column align-items-center hover-yellow" routerLink="/favoritos"
                            routerLinkActive="active">
                            <i class="bi bi-heart fs-5"></i>
                            <span>Favoritos</span>
                        </a>
                    </li>
                    <!-- <li class="nav-item mx-2">
                        <a class="nav-link d-flex flex-column align-items-center hover-yellow" routerLink="/sobre"
                            routerLinkActive="active">
                            <i class="bi bi-info-circle fs-5"></i>
                            <span>Sobre</span>
                        </a>
                    </li> -->
                </ul>

                <div class="d-flex align-items-center">
                    <ng-container *ngIf="isLoggedIn; else notLoggedIn">
                        <a routerLink="/notificacoes" class="btn btn-light position-relative me-3">
                            <i class="bi bi-bell"></i>
                            <span
                                class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                                *ngIf="notificacoesNaoLidas > 0">
                                {{ notificacoesNaoLidas > 9 ? '9+' : notificacoesNaoLidas }}
                                <span class="visually-hidden">notificações não lidas</span>
                            </span>
                        </a>

                        <a class="btn btn-warning me-3 hover-dark" routerLink="/criar-anuncio">
                            <i class="bi bi-plus-circle me-1"></i>
                            Fazer anúncio
                        </a>

                        <div class="dropdown">
                            <div class="d-flex align-items-center user-menu-trigger" id="userMenu"
                                data-bs-toggle="dropdown" aria-expanded="false">
                                <div class="user-info me-2 d-none d-md-block">
                                    <span class="fw-bold">{{ userName }}</span>
                                </div>
                                <div class="user-avatar">
                                    <img *ngIf="userProfilePic" [src]="userProfilePic" alt="Foto de perfil"
                                        class="user-profile-pic">
                                    <span *ngIf="!userProfilePic" class="user-initial">{{ userName.charAt(0) }}</span>
                                </div>
                            </div>
                            <ul class="dropdown-menu dropdown-menu-end shadow-sm" aria-labelledby="userMenu">
                                <li>
                                    <div class="dropdown-header px-3 py-2">
                                        <div class="fw-bold">{{ userName }}</div>
                                        <div class="text-muted small">{{ userEmail }}</div>
                                    </div>
                                </li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item hover-yellow" routerLink="/meus-anuncios">
                                        <i class="bi bi-star me-2"></i>Meus Anúncios
                                    </a></li>
                                <li><a class="dropdown-item hover-yellow" routerLink="/favoritos">
                                        <i class="bi bi-heart me-2"></i>Favoritos
                                    </a></li>
                                <li><a class="dropdown-item hover-yellow" routerLink="/notificacoes">
                                        <i class="bi bi-bell me-2"></i>Notificações
                                        <span class="badge bg-danger ms-1" *ngIf="notificacoesNaoLidas > 0">{{
                                            notificacoesNaoLidas }}</span>
                                    </a></li>
                                <li><a class="dropdown-item hover-yellow" routerLink="/minhas-reservas">
                                        <i class="bi bi-calendar-check me-2"></i>Ver Minhas Reservas
                                    </a></li>
                                <li><a class="dropdown-item hover-yellow" routerLink="/chat">
                                        <i class="bi bi-chat-dots me-2"></i>Chat
                                    </a></li>
                                <li><a class="dropdown-item hover-yellow" routerLink="/perfil">
                                        <i class="bi bi-person me-2"></i>Meu Perfil
                                    </a></li>
                                <li><a class="dropdown-item hover-yellow" routerLink="/configuracoes">
                                        <i class="bi bi-gear me-2"></i>Configurações
                                    </a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item hover-yellow" (click)="logout()">
                                        <i class="bi bi-box-arrow-right me-2"></i>Sair
                                    </a></li>
                            </ul>
                        </div>
                    </ng-container>

                    <ng-template #notLoggedIn>
                        <a class="btn btn-outline-warning me-2 hover-dark" routerLink="/login">
                            <i class="bi bi-box-arrow-in-right me-1"></i>Entrar
                        </a>
                        <a class="btn btn-warning hover-dark" routerLink="/registro">
                            <i class="bi bi-person-plus me-1"></i>Cadastrar
                        </a>
                    </ng-template>
                </div>
            </div>
        </div>
    </nav>

    <div class="d-lg-none bg-white border-bottom py-2 px-3 d-flex justify-content-between align-items-center">
        <a class="navbar-brand m-0" routerLink="/">
            <img src="Logo.png" alt="Easy Space" height="40">
        </a>
        <div class="d-flex align-items-center">
            <a routerLink="/notificacoes" class="btn btn-light position-relative me-2" *ngIf="isLoggedIn">
                <i class="bi bi-bell"></i>
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                    *ngIf="notificacoesNaoLidas > 0">
                    {{ notificacoesNaoLidas > 9 ? '9+' : notificacoesNaoLidas }}
                </span>
            </a>
            <button class="btn btn-warning btn-sm" routerLink="/criar-anuncio" *ngIf="isLoggedIn">
                <i class="bi bi-plus-lg"></i>
            </button>
        </div>
    </div>
</header>

<nav class="mobile-nav d-lg-none">
    <div class="container">
        <div class="row">
            <div class="col-3 text-center">
                <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"
                    class="mobile-nav-item">
                    <div class="mobile-nav-icon">
                        <i class="bi bi-house-door"></i>
                    </div>
                    <div class="mobile-nav-text">Home</div>
                </a>
            </div>
            <div class="col-3 text-center">
                <a routerLink="/explorar" routerLinkActive="active" class="mobile-nav-item">
                    <div class="mobile-nav-icon">
                        <i class="bi bi-search"></i>
                    </div>
                    <div class="mobile-nav-text">Explorar</div>
                </a>
            </div>
            <div class="col-3 text-center">
                <a routerLink="/favoritos" routerLinkActive="active" class="mobile-nav-item">
                    <div class="mobile-nav-icon">
                        <i class="bi bi-heart"></i>
                    </div>
                    <div class="mobile-nav-text">Favoritos</div>
                </a>
            </div>
            <div class="col-3 text-center">
                <ng-container *ngIf="isLoggedIn; else mobileLogin">
                    <a class="mobile-nav-item" data-bs-toggle="offcanvas" data-bs-target="#mobileUserMenu">
                        <div class="mobile-nav-icon">
                            <i class="bi bi-person"></i>
                        </div>
                        <div class="mobile-nav-text">Perfil</div>
                    </a>
                </ng-container>
                <ng-template #mobileLogin>
                    <a routerLink="/login" class="mobile-nav-item">
                        <div class="mobile-nav-icon">
                            <i class="bi bi-box-arrow-in-right"></i>
                        </div>
                        <div class="mobile-nav-text">Entrar</div>
                    </a>
                </ng-template>
            </div>
        </div>
    </div>
</nav>

<div class="offcanvas offcanvas-end" tabindex="-1" id="mobileUserMenu" *ngIf="isLoggedIn">
    <div class="offcanvas-header">
        <div class="d-flex align-items-center">
            <div class="user-avatar me-2">
                <img *ngIf="userProfilePic" [src]="userProfilePic" alt="Foto de perfil" class="user-profile-pic">
                <span *ngIf="!userProfilePic" class="user-initial">{{ userName.charAt(0) }}</span>
            </div>
            <div>
                <h5 class="offcanvas-title mb-0">{{ userName }}</h5>
                <div class="text-muted small">{{ userEmail }}</div>
            </div>
        </div>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
        <div class="list-group list-group-flush">
            <a routerLink="/meus-anuncios" class="list-group-item list-group-item-action">
                <i class="bi bi-star me-2"></i>Meus Anúncios
            </a>
            <a routerLink="/favoritos" class="list-group-item list-group-item-action">
                <i class="bi bi-heart me-2"></i>Favoritos
            </a>
            <a routerLink="/notificacoes" class="list-group-item list-group-item-action">
                <i class="bi bi-bell me-2"></i>Notificações
                <span class="badge bg-danger ms-1" *ngIf="notificacoesNaoLidas > 0">{{ notificacoesNaoLidas }}</span>
            </a>
            <a routerLink="/chat" class="list-group-item list-group-item-action">
                <i class="bi bi-calendar-check me-2"></i>Ver Minhas Reservas
            </a>
            <a routerLink="/chat" class="list-group-item list-group-item-action">
                <i class="bi bi-chat-dots me-2"></i>Chat
            </a>
            <a routerLink="/perfil" class="list-group-item list-group-item-action">
                <i class="bi bi-person me-2"></i>Meu Perfil
            </a>
            <a routerLink="/configuracoes" class="list-group-item list-group-item-action">
                <i class="bi bi-gear me-2"></i>Configurações
            </a>
            <a (click)="logout()" class="list-group-item list-group-item-action text-danger">
                <i class="bi bi-box-arrow-right me-2"></i>Sair
            </a>
        </div>
    </div>
</div>